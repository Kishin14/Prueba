// JavaScript Document

function LlenarFormEmpresas(){

    var terceroId = $('#tercero_id').val();

    RequiredRemove();

    var parametros  = new Array({campos:"tercero_id",valores:$('#tercero_id').val()});
	var forma       = document.forms[0];
	var controlador = 'EmpresasClass.php';

	FindRow(parametros,forma,controlador,null,function(resp){
	  
	  var data = $.parseJSON(resp);
	  ocultaFilaNombresRazon(data[0]['tipo_persona_id']);
	  
          if($('#guardar'))    $('#guardar').attr("disabled","true");
          if($('#actualizar')) $('#actualizar').attr("disabled","");
          if($('#borrar'))     $('#borrar').attr("disabled","");
          if($('#limpiar'))    $('#limpiar').attr("disabled","");	  
    });


}

function EmpresaOnSaveOnUpdateOnDelete(formulario,response){
	

  Reset(formulario);
  clearFind();	  
  $("#refresh_QUERYGRID_terceros").click();
  
  if($('#guardar'))    $('#guardar').attr("disabled","");
  if($('#actualizar')) $('#actualizar').attr("disabled","true");
  if($('#borrar'))     $('#borrar').attr("disabled","true");
  if($('#limpiar'))    $('#limpiar').attr("disabled","");	  
  
  jAlert(response);
	
}

function empresaOnReset(){
	
	Reset(document.forms[0]);
    clearFind();	
	
    if($('#guardar'))    $('#guardar').attr("disabled","");
    if($('#actualizar')) $('#actualizar').attr("disabled","true");
    if($('#borrar'))     $('#borrar').attr("disabled","true");
    if($('#limpiar'))    $('#limpiar').attr("disabled","");	
	
}

function calculador(){
	var rangoFin  = $("#fin_resolucion").val();
	var disponible= $("#inicio_disponible_res").val();
	
	var saldo     = parseInt(rangoFin) - parseInt(disponible) + parseInt(1);
	
	$("#saldo_res").val( saldo );
}

$(document).ready(function(){
						   
  $("#tipo_identificacion_id").change(function(){
    calculaDigitoTercero();
  });
  
  $("#numero_identificacion").blur(function(){

     var empresa_id            = $("#empresa_id").val();
     var numero_identificacion = this.value;
     var params                = new Array({campos:"numero_identificacion",valores:numero_identificacion});
	 
	 if(!empresa_id.length > 0){
		 
          validaRegistro(this,params,"EmpresasClass.php",null,function(resp){    
																  																  
          if(parseInt(resp) != 0 ){
            var params     = new Array({campos:"numero_identificacion",valores:numero_identificacion});
            var formulario = document.forms[0];
            var url        = 'EmpresasClass.php';

            FindRow(params,formulario,url,null,function(resp){

  	    var data = $.parseJSON(resp);

   	    ocultaFilaNombresRazon(data[0]['tipo_persona_id']);

            clearFind();
		 
	    $('#guardar').attr("disabled","true");
            $('#actualizar').attr("disabled","");
            $('#borrar').attr("disabled","");
            $('#limpiar').attr("disabled","");	


            });

	  }else{	   		  
             calculaDigitoTercero();				  
	     $('#guardar').attr("disabled","");
             $('#actualizar').attr("disabled","true");
             $('#borrar').attr("disabled","true");
             $('#limpiar').attr("disabled","");
	    }
		  
       });
	   
	 }
 
  
  });
  
  $("#guardar,#actualizar").click(function(){
	  
	  var formulario = document.getElementById('TercerosForm');
	  
	  if(ValidaRequeridos(formulario) && ValidaOtrosTercero(formulario)){ 
	    if(this.id == 'guardar'){
         Send(formulario,'onclickSave',null,EmpresaOnSaveOnUpdateOnDelete);
		}else{
            Send(formulario,'onclickUpdate',null,EmpresaOnSaveOnUpdateOnDelete);
		  }
	  }
	  	  
  });
  
  	
  $("#tipo_persona_id").change(function(){
    
    ocultaFilaNombresRazon(this.value);
    
  });
	

});